:root{
  --bg:#0b0f1a; --panel:#0f172a; --panel-2:#131c33; --text:#e5e7eb; --muted:#9aa4b2;
  --accent:#7c3aed; --p1:#ef4444; --p2:#f59e0b; --win:#22d3ee; --shadow:0 10px 30px rgba(0,0,0,.45);
}
[data-theme="light"]{
  --bg:#f5f7fb; --panel:#fff; --panel-2:#eef2ff; --text:#0b1220; --muted:#4b5563; --accent:#7c3aed;
  --shadow:0 10px 30px rgba(2,6,23,.12);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
  color:var(--text);
  background: radial-gradient(1200px 800px at 10% -10%, rgba(124,58,237,.25), transparent 50%),
              radial-gradient(1000px 700px at 110% 10%, rgba(34,211,238,.22), transparent 50%), var(--bg);
  display:flex; flex-direction:column; gap:16px;
}
header{position:sticky; top:0; z-index:3; backdrop-filter:saturate(140%) blur(8px);
  background:linear-gradient(180deg, rgba(0,0,0,.25), transparent); padding:16px 20px 8px;}
.wrap{max-width:1100px; margin:0 auto; width:100%}
.topbar{display:flex; gap:12px; align-items:center; justify-content:space-between}
.title{display:flex; align-items:baseline; gap:10px}
.title h1{font-size:clamp(18px,3vw,28px); margin:0; letter-spacing:.5px}
.badge{font-size:12px; padding:4px 10px; border-radius:999px; background:linear-gradient(90deg,var(--accent),#22d3ee); color:#fff; box-shadow:var(--shadow)}

.controls{display:flex; gap:8px; flex-wrap:wrap}
button, .seg{border:0; background:var(--panel); color:var(--text); padding:10px 14px; border-radius:12px; cursor:pointer; box-shadow:var(--shadow); transition:.2s transform,.2s filter}
button:hover{transform:translateY(-2px)} button:active{transform:translateY(0)}
.seg{display:flex; gap:4px; align-items:center; background:var(--panel-2)}
.seg input{display:none}
.seg label{padding:8px 12px; border-radius:8px; cursor:pointer; color:var(--muted)}
.seg input:checked + label{background:var(--panel); color:var(--text); box-shadow:var(--shadow)}

main{display:grid; place-items:center; padding:0 16px 24px}
.board-wrap{display:grid; gap:14px; justify-items:center}
.status{font-size:14px; color:var(--muted)}
.score{display:flex; gap:8px; align-items:center; font-size:14px}
.dot{width:10px; height:10px; border-radius:50%}

.stage{position:relative; perspective:1000px}
.board{
  --cols:7; --rows:6; --cell:clamp(52px,7vw,84px); --gap:12px;
  position:relative; display:grid; grid-template-columns:repeat(var(--cols),var(--cell)); grid-auto-rows:var(--cell);
  gap:var(--gap); padding:var(--gap); border-radius:22px; background:linear-gradient(135deg,#1f2a44,#0f172a 55%,#0b1020);
  box-shadow:inset 0 -8px 20px rgba(0,0,0,.35), var(--shadow); transform:rotateX(8deg);
}
.col-heads{position:absolute; inset:0; padding:var(--gap); display:grid; grid-template-columns:repeat(var(--cols),var(--cell)); grid-auto-rows:var(--cell); gap:var(--gap); pointer-events:none}
.col-heads .head{position:relative; height:var(--cell); border-radius:12px; display:grid; place-items:center; opacity:.0; transition:.25s opacity}
.col-heads .head::after{content:""; width:12px; height:12px; border:2px dashed rgba(255,255,255,.6); border-radius:50%; animation:blink 1.1s infinite}
@keyframes blink{50%{transform:translateY(-4px); opacity:.4}}
.board:hover .col-heads .head{opacity:.4}

.cell{position:relative; display:grid; place-items:center; border-radius:50%;
  background:radial-gradient(60% 60% at 35% 35%, #0a1223, #060b16 70%);
  box-shadow:inset 0 10px 18px rgba(0,0,0,.55), inset 0 -10px 18px rgba(255,255,255,.02);
  overflow:visible;
}
.token{position:absolute; width:88%; height:88%; border-radius:50%; transform:translateY(-120vh) scale(.98); will-change:transform,filter;
  box-shadow:0 8px 18px rgba(0,0,0,.45), inset 0 -10px 18px rgba(0,0,0,.3), inset 0 10px 18px rgba(255,255,255,.08);}
.token.p1{background:radial-gradient(60% 60% at 35% 35%, #ff8b8b, var(--p1))}
.token.p2{background:radial-gradient(60% 60% at 35% 35%, #ffd68a, var(--p2))}
.token.drop{transition:transform .42s cubic-bezier(.22,.75,.14,1.05), filter .42s}

.cell.win .token{outline:3px solid var(--win); filter:drop-shadow(0 0 10px rgba(34,211,238,.8)); animation:pulse 1.2s infinite ease-in-out}
@keyframes pulse{50%{transform:translateY(0) scale(1.04)}}

.legend{display:flex; align-items:center; gap:12px; justify-content:center}
.legend .pill{display:flex; align-items:center; gap:8px; background:var(--panel); padding:8px 12px; border-radius:999px; box-shadow:var(--shadow)}
.actions{display:flex; gap:8px; flex-wrap:wrap; justify-content:center}

.sr-only{position:absolute; width:1px; height:1px; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap}
canvas#confetti{position:fixed; inset:0; pointer-events:none; z-index:5}
footer{padding-bottom:24px}

@media (max-width:600px){
  .board{ --cell:12.5vw; --gap:8px }
  .col-heads .head::after{display:none}
}
